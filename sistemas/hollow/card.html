<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Criador de Cartas</title>
<style>
  body {
    margin: 0;
    font-family: sans-serif;
    background: #222;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }
  h1 {
    margin-bottom: 20px;
  }
  .form {
    background: #333;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    width: 300px;
  }
  .form input, .form button {
    width: 100%;
    margin: 5px 0;
    padding: 8px;
    border: none;
    border-radius: 5px;
  }
  .form button {
    background: #28a745;
    color: #fff;
    cursor: pointer;
  }
  .form button:hover {
    background: #218838;
  }
  .preview, .card-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .card {
    position: relative;
    width: 120px;
    height: 160px;
    background: #444;
    border: 2px solid #666;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    overflow: hidden;
  }
  .card img {
    max-width: 80px;
    max-height: 80px;
  }
  .number {
    position: absolute;
    background: rgba(0,0,0,0.6);
    padding: 2px 5px;
    border-radius: 5px;
    font-size: 14px;
  }
  .top { top: 2px; left: 50%; transform: translateX(-50%); }
  .bottom { bottom: 2px; left: 50%; transform: translateX(-50%); }
  .left { left: 2px; top: 50%; transform: translateY(-50%); }
  .right { right: 2px; top: 50%; transform: translateY(-50%); }
  .card-name {
    position: absolute;
    bottom: 5px;
    font-size: 12px;
    text-align: center;
    width: 100%;
  }
  .delete-btn {
    position: absolute;
    top: 2px;
    right: 2px;
    cursor: pointer;
    background: rgba(255,0,0,0.8);
    border-radius: 50%;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 14px;
  }
</style>
</head>
<body>
  <h1>Criador de Cartas</h1>
  <div class="form">
    <input type="text" id="nameInput" placeholder="Nome da Carta">
    <input type="number" id="topInput" placeholder="Topo">
    <input type="number" id="rightInput" placeholder="Direita">
    <input type="number" id="bottomInput" placeholder="Baixo">
    <input type="number" id="leftInput" placeholder="Esquerda">
    <input type="file" id="imageInput" accept="image/png,image/jpeg,image/jpg,image/webp">
    <div class="preview">
      <div class="card" id="previewCard">
        <img id="previewImage" style="display:none;">
        <div class="number top"></div>
        <div class="number right"></div>
        <div class="number bottom"></div>
        <div class="number left"></div>
        <div class="card-name"></div>
      </div>
    </div>
    <button id="addCardBtn">Adicionar Carta</button>
    <button id="exportBtn">Exportar Cartas</button>
  </div>

  <h2>Cartas Salvas</h2>
  <div class="card-list" id="cardList"></div>

<script>
  const nameInput = document.getElementById('nameInput');
  const topInput = document.getElementById('topInput');
  const rightInput = document.getElementById('rightInput');
  const bottomInput = document.getElementById('bottomInput');
  const leftInput = document.getElementById('leftInput');
  const imageInput = document.getElementById('imageInput');
  const previewCard = document.getElementById('previewCard');
  const previewImage = document.getElementById('previewImage');
  const addCardBtn = document.getElementById('addCardBtn');
  const exportBtn = document.getElementById('exportBtn');
  const cardListDiv = document.getElementById('cardList');

  let savedCards = JSON.parse(localStorage.getItem('cards')) || [];
  let currentImage = "";

  // Atualiza preview
  function updatePreview(){
    previewCard.querySelector('.number.top').textContent = topInput.value;
    previewCard.querySelector('.number.right').textContent = rightInput.value;
    previewCard.querySelector('.number.bottom').textContent = bottomInput.value;
    previewCard.querySelector('.number.left').textContent = leftInput.value;
    previewCard.querySelector('.card-name').textContent = nameInput.value;
    if(currentImage){
      previewImage.src = currentImage;
      previewImage.style.display = 'block';
    } else {
      previewImage.style.display = 'none';
    }
  }

  [nameInput, topInput, rightInput, bottomInput, leftInput].forEach(input=>{
    input.addEventListener('input', updatePreview);
  });

  imageInput.addEventListener('change', (e)=>{
    const file = e.target.files[0];
    if(file && file.type.startsWith('image/')){
      const reader = new FileReader();
      reader.onload = ()=>{
        currentImage = reader.result;
        updatePreview();
      };
      reader.readAsDataURL(file);
    }
  });

  function createCardElement(card, index){
    const div = document.createElement('div');
    div.classList.add('card');
    div.dataset.index = index;

    if(card.image){
      const img = document.createElement('img');
      img.src = card.image;
      div.appendChild(img);
    }

    ['top','right','bottom','left'].forEach(side=>{
      const n = document.createElement('div');
      n.classList.add('number', side);
      n.textContent = card[side];
      div.appendChild(n);
    });

    const nameDiv = document.createElement('div');
    nameDiv.classList.add('card-name');
    nameDiv.textContent = card.name;
    div.appendChild(nameDiv);

    const deleteBtn = document.createElement('div');
    deleteBtn.classList.add('delete-btn');
    deleteBtn.textContent = 'Ã—';
    deleteBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      savedCards.splice(index,1);
      localStorage.setItem('cards', JSON.stringify(savedCards));
      loadSavedCards();
    });
    div.appendChild(deleteBtn);

    return div;
  }

  function loadSavedCards(){
    cardListDiv.innerHTML = '';
    savedCards.forEach((card,index)=>{
      const div = createCardElement(card,index);
      cardListDiv.appendChild(div);
    });
  }

  addCardBtn.addEventListener('click', ()=>{
    const card = {
      name: nameInput.value,
      top: topInput.value,
      right: rightInput.value,
      bottom: bottomInput.value,
      left: leftInput.value,
      image: currentImage
    };
    savedCards.push(card);
    localStorage.setItem('cards', JSON.stringify(savedCards));
    loadSavedCards();
    nameInput.value = '';
    topInput.value = '';
    rightInput.value = '';
    bottomInput.value = '';
    leftInput.value = '';
    imageInput.value = '';
    currentImage = '';
    updatePreview();
  });

  // Exporta cartas para JSON
  exportBtn.addEventListener('click', ()=>{
    const dataStr = JSON.stringify(savedCards, null, 2);
    const blob = new Blob([dataStr], {type: "application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "cartas.json";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  loadSavedCards();
  updatePreview();
</script>
</body>
</html>
