<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Mapa Interativo</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
    canvas {
      display: block;
      cursor: grab;
    }
    canvas:active {
      cursor: grabbing;
    }
  </style>
</head>
<body>
  <canvas id="mapCanvas"></canvas>

  <script>
    const canvas = document.getElementById("mapCanvas");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      draw();
    }
    window.addEventListener("resize", resize);

    const mapImg = new Image();
    mapImg.src = "map.png";
    mapImg.onload = () => resize();

    // Estado da cÃ¢mera
    let scale = 1;
    let offsetX = 0;
    let offsetY = 0;

    let isDragging = false;
    let lastX, lastY;

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.save();
      ctx.translate(offsetX, offsetY);
      ctx.scale(scale, scale);
      ctx.drawImage(mapImg, 0, 0);
      ctx.restore();
    }

    // Drag mouse
    canvas.addEventListener("mousedown", (e) => {
      isDragging = true;
      lastX = e.clientX;
      lastY = e.clientY;
    });

    canvas.addEventListener("mousemove", (e) => {
      if (isDragging) {
        offsetX += e.clientX - lastX;
        offsetY += e.clientY - lastY;
        lastX = e.clientX;
        lastY = e.clientY;
        draw();
      }
    });

    canvas.addEventListener("mouseup", () => { isDragging = false; });
    canvas.addEventListener("mouseleave", () => { isDragging = false; });

    // Zoom scroll
    canvas.addEventListener("wheel", (e) => {
      e.preventDefault();
      const zoomIntensity = 0.001;
      const mouseX = (e.clientX - offsetX) / scale;
      const mouseY = (e.clientY - offsetY) / scale;

      const newScale = scale * (1 - e.deltaY * zoomIntensity);

      offsetX -= mouseX * (newScale - scale);
      offsetY -= mouseY * (newScale - scale);

      scale = newScale;
      draw();
    });

    // Reset duplo clique
    canvas.addEventListener("dblclick", () => {
      scale = 1;
      offsetX = 0;
      offsetY = 0;
      draw();
    });

    // Pinch zoom
    let lastDist = null;
    canvas.addEventListener("touchstart", (e) => {
      if (e.touches.length === 2) {
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        lastDist = Math.sqrt(dx * dx + dy * dy);
      }
    });

    canvas.addEventListener("touchmove", (e) => {
      if (e.touches.length === 2) {
        e.preventDefault();
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        const dist = Math.sqrt(dx * dx + dy * dy);

        if (lastDist) {
          const zoom = dist / lastDist;
          const midX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
          const midY = (e.touches[0].clientY + e.touches[1].clientY) / 2;

          const worldX = (midX - offsetX) / scale;
          const worldY = (midY - offsetY) / scale;

          scale *= zoom;

          offsetX -= worldX * (scale / (scale / zoom) - 1);
          offsetY -= worldY * (scale / (scale / zoom) - 1);

          draw();
        }
        lastDist = dist;
      }
    });

    canvas.addEventListener("touchend", () => {
      lastDist = null;
    });
  </script>
</body>
</html>
