<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Hollow Knight RPG - Personagens</title>
  <style>
    body {
      font-family: 'Franklin Gothic Medium','Arial Narrow',sans-serif;
      margin:0; padding:0;
      display:flex; flex-direction:column; align-items:flex-start;
      min-height:100vh;
      background:linear-gradient(135deg,#0d1b2a,#1a2a4d);
      color:#e0e0e0;
      position:relative; overflow:hidden;
    }
    h1 { margin:30px 0 30px 20px; color:#a0c4ff; }

    #personagensContainer{
      display:flex; flex-wrap:wrap;
      justify-content:flex-start;
      gap:12px;
      width:95%; max-width:1000px;
      z-index:1; padding:10px 0 10px 20px;
    }

    .personagem-btn{
      position:relative;
      cursor:pointer;
      border-radius:8px;
      background:rgba(17, 20, 36, 0.8);
      padding:6px;
      width:300px; height:90px;
      display:flex;
      align-items:center;
      transition:transform .18s, box-shadow .18s, background-color .18s;
    }
    .personagem-btn:hover{
      transform:scale(1.08);
      box-shadow:0 0 30px #090b11;
      background-color:#142e4e;
    }
    .personagem-btn.selected{outline:3px solid rgba(116,192,252,0.7);}
    .personagem-btn.highlight{
      animation:pop .9s ease forwards;
    }
    @keyframes pop{
      0%{transform:scale(.6);opacity:0;}
      60%{transform:scale(1.15);opacity:1;}
      100%{transform:scale(1);opacity:1;}
    }

    .delete-btn{
      position:absolute;
      top:3px; left:3px;
      width:18px; height:18px;
      border:none; border-radius:50%;
      background:transparent;
      cursor:pointer; z-index:2;
      display:flex; align-items:center; justify-content:center;
      transition:opacity .2s;
      padding:0;
    }
    .delete-btn img{width:100%; height:100%;}
    .delete-btn:hover img{opacity:0.8;}

    .personagem-img{
      width:80px; height:80px;
      object-fit:contain;
      margin-right:12px;
    }
    .personagem-info{
      display:flex; flex-direction:column;
      justify-content:center;
      color:#e0e0e0;
      font-size:14px;
    }
    .personagem-info b{margin-bottom:4px;}

    #btnCriar{
      position:absolute; top:20px; right:20px;
      background:#1a2a4d; color:#fff; border:none;
      padding:10px 16px; border-radius:8px; cursor:pointer;
      z-index:2;
    }
    #btnCriar:hover{background:#0f1b36;}

    #bgParticles{
      position:fixed; top:0; left:0;
      width:100%; height:100%;
      z-index:0; pointer-events:none;
    }

    /* Modal de criação */
    #modalCriar{
      display:none;
      position:fixed;
      top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6);
      z-index:10;
      align-items:center; justify-content:center;
    }
    #modalContent{
      background:#161e30;
      padding:20px; border-radius:12px;
      min-width:320px;
      display:flex; flex-direction:column; gap:12px;
      color:#e0e0e0;
    }
    #modalContent label{margin-bottom:4px;}
    #modalContent input, #modalContent select{
      padding:6px;
      border-radius:6px;
      border:none;
      outline:none;
      background:#131f32;
      color:#e0e0e0;
    }
    #modalContent input::placeholder{color:#b0c4ff;}

    #modalButtons{
      display:flex; justify-content:flex-end; gap:10px;
      margin-top:10px;
    }
    .modalBtn{
      padding:6px 12px;
      border:none; border-radius:6px;
      cursor:pointer; background:#343434; color:#fff;
      transition:background .2s;
    }
    .modalBtn:hover{background:#505050;}

    /* Modal de exclusão */
    #modalExcluir{
      display:none;
      position:fixed;
      top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.6);
      z-index:11;
      align-items:center; justify-content:center;
    }
    #modalExcluirContent{
      background:#161e30;
      padding:20px; border-radius:12px;
      min-width:320px;
      display:flex; flex-direction:column; gap:12px;
      color:#e0e0e0;
    }
    #modalExcluirContent input{
      padding:6px; border-radius:6px; border:none;
      outline:none; background:#131f32; color:#e0e0e0;
    }
    #modalExcluirContent .info{font-size:14px; margin-bottom:6px;}
  </style>
</head>
<body>
  <h1>Hollow Knight RPG</h1>
  <button id="btnCriar">Criar Novo</button>

  <div id="personagensContainer"></div>

  <!-- Modal de criação -->
  <div id="modalCriar">
    <div id="modalContent">
      <label>Nome do Personagem:</label>
      <input type="text" id="nomePersonagem" placeholder="Digite o nome">
      <label>Raça:</label>
      <select id="racaPersonagem">
        <option>Mariposa</option>
        <option>Skaar</option>
        <option>Baldur</option>
        <option>Mosca</option>
        <option>Tecelã</option>
      </select>
      <label>Tamanho:</label>
      <select id="tamanhoPersonagem">
        <option>pequeno</option>
        <option>médio</option>
        <option>grande</option>
      </select>
      <div id="modalButtons">
        <button class="modalBtn" id="cancelarBtn">Cancelar</button>
        <button class="modalBtn" id="criarBtn">Criar</button>
      </div>
    </div>
  </div>

  <!-- Modal de exclusão -->
  <div id="modalExcluir">
    <div id="modalExcluirContent">
      <div class="info" id="palavraExcluirInfo"></div>
      <input type="text" id="excluirInput" placeholder="Digite aqui">
      <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:10px;">
        <button class="modalBtn" id="cancelarExcluirBtn">Cancelar</button>
        <button class="modalBtn" id="confirmExcluirBtn">Excluir</button>
      </div>
    </div>
  </div>

  <canvas id="bgParticles"></canvas>

  <script>
    const container = document.getElementById('personagensContainer');
    const modal = document.getElementById('modalCriar');
    const btnCriar = document.getElementById('btnCriar');
    const criarBtn = document.getElementById('criarBtn');
    const cancelarBtn = document.getElementById('cancelarBtn');

    const nomeInput = document.getElementById('nomePersonagem');
    const racaSelect = document.getElementById('racaPersonagem');
    const tamanhoSelect = document.getElementById('tamanhoPersonagem');

    const modalExcluir = document.getElementById('modalExcluir');
    const excluirInput = document.getElementById('excluirInput');
    const cancelarExcluirBtn = document.getElementById('cancelarExcluirBtn');
    const confirmExcluirBtn = document.getElementById('confirmExcluirBtn');
    const palavraExcluirInfo = document.getElementById('palavraExcluirInfo');

    const palavras = ['Guaraná', 'Shaw', 'Git Gud', 'Edino', 'Regale'];

    function salvar(personagens){ localStorage.setItem('portal_personagens', JSON.stringify(personagens)); }
    function carregar(){ return JSON.parse(localStorage.getItem('portal_personagens')) || []; }
    let personagens = carregar();
    let personagemParaExcluir = null;
    let palavraAtual = '';

    function renderPersonagem(p, highlight=false){
      const card = document.createElement('div');
      card.className = 'personagem-btn';
      card.dataset.nome = p.nome;
      card.innerHTML = `
        <img class="personagem-img" src="${p.imagem}" alt="${p.nome}">
        <div class="personagem-info">
          <b>${p.nome}</b>
          <span>Raça: ${p.raca || '-'}</span>
          <span>Tamanho: ${p.tamanho || '-'}</span>
        </div>
      `;

      const del = document.createElement('button');
      del.className = 'delete-btn';
      const delImg = document.createElement('img');
      delImg.src = 'Trashy.png';
      del.appendChild(delImg);
      del.addEventListener('click', e=>{
        e.stopPropagation();
        personagemParaExcluir = {p, card};
        palavraAtual = palavras[Math.floor(Math.random() * palavras.length)];
        palavraExcluirInfo.innerHTML = `Digite a palavra <b>${palavraAtual}</b> para excluir o personagem`;
        excluirInput.value = '';
        modalExcluir.style.display = 'flex';
      });
      card.appendChild(del);

      card.addEventListener('click', ()=>{
        document.querySelectorAll('.personagem-btn').forEach(el=>el.classList.remove('selected'));
        card.classList.add('selected');
        localStorage.setItem('portal_personagemSelecionado', p.nome);
      });

      card.addEventListener('dblclick', ()=>{
        // abre a ficha na pasta Ficha
        window.location.href = `ficha/Ficha.html`;
      });

      container.appendChild(card);

      if(highlight){
        card.classList.add('highlight');
        setTimeout(()=>card.classList.remove('highlight'),900);
        card.classList.add('selected');
      }
    }

    function renderAll(){
      container.innerHTML='';
      personagens.forEach(p=>renderPersonagem(p));
    }
    renderAll();

    btnCriar.addEventListener('click', ()=>{
      nomeInput.value = '';
      racaSelect.value = 'Mariposa';
      tamanhoSelect.value = 'pequeno';
      modal.style.display = 'flex';
    });
    cancelarBtn.addEventListener('click', ()=>{ modal.style.display = 'none'; });

    criarBtn.addEventListener('click', ()=>{
      const nome = nomeInput.value.trim();
      if(!nome) return alert("Digite um nome válido!");
      const raca = racaSelect.value;
      const tamanho = tamanhoSelect.value;
      const novo = { nome: nome, raca, tamanho, imagem: 'New.png', pagina: `Ficha/Novo_${Date.now()}.html` };
      personagens.push(novo);
      salvar(personagens);
      renderPersonagem(novo,true);
      modal.style.display = 'none';
    });

    cancelarExcluirBtn.addEventListener('click', ()=>{ modalExcluir.style.display='none'; personagemParaExcluir=null; });
    confirmExcluirBtn.addEventListener('click', ()=>{
      if(!personagemParaExcluir) return;
      const texto = excluirInput.value.trim();
      if(texto === palavraAtual){
        personagens = personagens.filter(x=>x!==personagemParaExcluir.p);
        salvar(personagens);
        personagemParaExcluir.card.remove();
        modalExcluir.style.display='none';
        personagemParaExcluir=null;
      } else {
        alert(`Palavra incorreta! Digite exatamente: "${palavraAtual}".`);
      }
    });
  </script>

  <script>
    const canvas = document.getElementById('bgParticles');
    const ctx = canvas.getContext('2d');
    function resize(){ canvas.width=innerWidth; canvas.height=innerHeight; }
    resize(); window.addEventListener('resize',resize);

    class Particle {
      constructor(){
        this.x=Math.random()*canvas.width;
        this.y=Math.random()*canvas.height;
        this.size=Math.random()*3+1;
        this.vx=Math.random()*1-0.5;
        this.vy=Math.random()*1-0.5;
      }
      update(){
        this.x+=this.vx; this.y+=this.vy;
        if(this.x<0||this.x>canvas.width) this.vx*=-1;
        if(this.y<0||this.y>canvas.height) this.vy*=-1;
      }
      draw(){
        ctx.fillStyle="rgba(160,196,255,0.8)";
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fill();
      }
    }
    const particles = Array.from({length:100},()=>new Particle());
    (function animate(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach(p=>{p.update();p.draw();});
      requestAnimationFrame(animate);
    })();
  </script>
</body>
</html>
